As nesting structure could be large, I had to come up with a recourse func. No compications